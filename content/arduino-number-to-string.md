---
title: –ö–∞–∫ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —á–∏—Å–ª–æ –≤ —Å—Ç—Ä–æ–∫—É –≤ Arduino?
emoji: üî¢
created: 2021-06-29
modified: 2021-06-29
tags:
  - Arduino
---

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å Arduino –∏–Ω–æ–≥–¥–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∑–∞–¥–∞—á–∞ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥–∏—Å–ø–ª–µ–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å –¥–∞—Ç—á–∏–∫–æ–≤.

–ü–æ–¥–æ–±–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ–±—ã—á–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —á–∏—Å–ª–æ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏, –∞ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ.

–ù–∞ –ø–æ–º–æ—â—å –Ω–∞–º –ø—Ä–∏—Ö–æ–¥–∏—Ç –∑–Ω–∞–∫–æ–º–∞—è –≤—Å–µ–º C++ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞–º —Ñ—É–Ω–∫—Ü–∏—è `sprintf()`, –Ω–æ –≤—Å–µ –Ω–µ —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ.

## –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –≤ —Å—Ç—Ä–æ–∫—É

### –†–µ—à–µ–Ω–∏–µ 1. –ò—Å–ø–æ–ª—å–∑—É–µ–º sprintf(buffer, format, ...val1, val2)

```cpp
int led_count = 5;
char buff[20];
sprintf(buff, "led count: %d", led_count); // "led count: 5"
```

### –†–µ—à–µ–Ω–∏–µ 2. –ò—Å–ø–æ–ª—å–∑—É–µ–º itoa(integer_value, buffer, base)

```cpp
int led_count = 5;
char buff[20];
itoa(led_count, buff, 10); // "5"
```

## –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –≤ —Å—Ç—Ä–æ–∫—É

–§—É–Ω–∫—Ü–∏—è sprintf() –≤ Arduino –≤–µ–¥–µ—Ç —Å–µ–±—è –Ω–µ –∫–∞–∫ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ C++. 

–ï—Å–ª–∏ –≤—ã –ø–æ–ø—ã—Ç–∞–µ—Ç–µ—Å—å –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ —Å –ø–æ–º–æ—â—å—é sprintf(), —Ç–æ –ø–æ–ª—É—á–∏—Ç–µ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

```cpp
float voltage = 5.6;
char buff[20];
sprintf(buff, "voltage: %0.2f", voltage); // "voltage: ?"
```

–í—ã –∑–∞–º–µ—Ç–∏–ª–∏ —á—Ç–æ –≤–º–µ—Å—Ç–æ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞ —É –≤–∞—Å –æ—Ç–æ–±—Ä–∞–∑–∏–ª—Å—è —Å–∏–º–≤–æ–ª "?" ?

Arduino –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ avr-gcc, –≤ –µ–≥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–∫–ª—é—á–µ–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è sprintf(). –°–¥–µ–ª–∞–Ω–æ —ç—Ç–æ –±—ã–ª–æ –æ—á–µ–Ω—å –¥–∞–≤–Ω–æ, –∏ –≤ —Ç–µ –¥–∞–ª–µ–∫–∏–µ –≤—Ä–µ–º–µ–Ω–∞ —ç—Ç–æ –æ–±—ä—è—Å–Ω—è–ª–æ—Å—å —ç–∫–æ–Ω–æ–º–∏–µ–π –ø–∞–º—è—Ç–∏. –î–æ —Å–∏—Ö –ø–æ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ Arduino –Ω–µ –ø—Ä–∏–ª–æ–∂–∏–ª–∏ –Ω–∏–∫–∞–∫–∏—Ö —É—Å–∏–ª–∏–π —á—Ç–æ–±—ã –∏—Å–ø—Ä–∞–≤–∏—Ç—å —ç—Ç–æ—Ç –¥–æ—Å–∞–¥–Ω—ã–π –º–æ–º–µ–Ω—Ç.

### –†–µ—à–µ–Ω–∏–µ 1. –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å –ø–æ–º–æ—â—å—é dtostrf(float_value, string_length, number_after_decimal, buffer)

–ü–∞—Ä–∞–º–µ—Ç—Ä `string_length` –∑–∞–¥–∞–µ—Ç –¥–ª–∏–Ω—É –∏—Ç–æ–≥–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏, –¥–æ–ª–∂–µ–Ω –≤–∫–ª—é—á–∞—Ç—å –º–µ—Å—Ç–æ –ø–æ–¥ —Å–∏–º–≤–æ–ª—ã "." –∏ "-".

–ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ `string_length` - –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –∏ –∏—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –º–µ–Ω—å—à–µ —á–µ–º `string_length`, —Ç–æ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–µ–ª—ã —Å–ª–µ–≤–∞.

–ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ `string_length` - –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∏ –∏—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –º–µ–Ω—å—à–µ —á–µ–º `string_length`, —Ç–æ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–µ–ª—ã —Å–ø—Ä–∞–≤–∞.

```cpp
char buffer[30];
float temperature = 24.75;
float pressure = 733.93;

char str_temperature[6];
dtostrf(temperature, 6, 2, str_temperature); // " 24.75"

char str_pressure[7];
dtostrf(pressure, -7, 2, str_pressure); // "733.93 "

sprintf(buffer, "%s C, %s mmHg", str_temperature, str_pressure); " 24.75 C, 733.93 mmHg"
```

### –†–µ—à–µ–Ω–∏–µ 2. –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å –ø–æ–º–æ—â—å—é —Ñ–ª–∞–≥–æ–≤ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞

–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é –≤ —Å–∞–º–æ–º Arduino —É –≤–∞—Å –Ω–µ –ø–æ–ª—É—á–∏—Ç—å—Å—è –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–ª–∞–≥–∏ —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –≤–∞—à —Å–∫–µ—Ç—á.

–ù–æ –µ—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ PlatformIO –∏–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–¥–æ–±–Ω–æ–µ, —Ç–æ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω—É–∂–Ω—ã–µ —Ñ–ª–∞–≥–∏ –∏ –≤–∫–ª—é—á–∏—Ç—å –ø–æ–ª–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ sprintf().

```bash
-Wl,-u,vfprintf -lprintf_flt -lm
```

### –†–µ—à–µ–Ω–∏–µ 3. –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å –ø–æ–º–æ—â—å—é sprintf() + %d.%d

–ú–æ–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –Ω–∞ 2 —á–∞—Å—Ç–∏ –∏ –≤—ã–≤–µ—Å—Ç–∏ –∫–∞–∂–¥—É—é —á–∞—Å—Ç—å –∫–∞–∫ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ.

```cpp
int fractionalToInt(float value, byte decimal_places = 2) {
  return int((abs(value) - (int)abs(value)) * pow(10, decimal_places));
}

float humidity = 35.89;
char buff[20];
sprintf(buff, "humidity: %d.%d", (int)humidity, fractionalToInt(humidity)); "humidity: 35.89"
```